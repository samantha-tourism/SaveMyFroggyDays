{"ast":null,"code":"var _jsxFileName = \"/Users/Samantha/Documents/Education/Wild/Projet2/final/remote-js-202011-froggy-devs/src/components/Result.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport CardContainer from \"./CardContainer\";\nimport APIKEY from \"./ApiKeyTourism\";\nimport \"./Result.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst limit = 1;\nconst radius = 1000; // in meters\n\nconst Result = props => {\n  _s();\n\n  const [arrayActivities, setArrayActivities] = useState([]);\n  const [offset, setOffset] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [city, setCity] = useState(\"\");\n  const [rain, setRain] = useState(props.rain);\n  const inter = useRef(null);\n\n  const clear = () => {\n    window.clearInterval(inter.current);\n  };\n\n  useEffect(() => {\n    async function request(props, offset) {\n      let arrayAct = [];\n      const coordsCity = await fetch(`http://api.opentripmap.com/0.1/en/places/geoname?apikey=${APIKEY}&name=${props.city}`).then(res => res.json());\n      if (coordsCity.hasOwnProperty(\"error\")) arrayAct = \"404\";else {\n        const {\n          lat,\n          lon\n        } = coordsCity;\n        clear();\n\n        if (city !== props.city || rain !== props.rain) {\n          // when the user makes a new research, reset\n          setOffset(0);\n          setCity(props.city);\n          setRain(props.rain);\n          setArrayActivities([]);\n        } // can't forEach when using async funcions\n\n\n        let i = 0;\n        inter.current = setInterval(async function () {\n          const listActivities = await fetch(`https://api.opentripmap.com/0.1/en/places/radius?apikey=${APIKEY}&radius=${radius}&limit=${limit}&offset=${offset}&lon=${lon}&lat=${lat}&rate=1&format=json`).then(res => res.json());\n\n          if (!listActivities[i] || listActivities.length === 0) {\n            clear();\n            return;\n          }\n\n          const activitiesData = await fetch(`https://api.opentripmap.com/0.1/en/places/xid/${listActivities[i].xid}?apikey=${APIKEY}`).then(res => res.json());\n\n          if (activitiesData.kinds && !(activitiesData.kinds.includes(\"accomodation\") || activitiesData.kinds.includes(\"unclassified_objects\") || activitiesData.kinds.includes(\"banks\") || activitiesData.kinds.includes(\"transport\") || activitiesData.kinds.includes(\"industrial\")) && (!props.rain || !(activitiesData.kinds.includes(\"natural\") || activitiesData.kinds.includes(\"historic\") || activitiesData.kinds.includes(\"architecture\") || activitiesData.kinds.includes(\"urban_environment\"))) && (props.checkedAdult || !activitiesData.kinds.includes(\"adult\")) && (props.checkedRelig || !activitiesData.kinds.includes(\"religion\")) && (props.checkedRest || !activitiesData.kinds.includes(\"foods\")) && (props.checkedSport || !activitiesData.kinds.includes(\"sport\")) && (props.checkedShop || !activitiesData.kinds.includes(\"shops\"))) {\n            arrayAct.push(activitiesData);\n          }\n\n          i++;\n          setOffset(offset + 1);\n          setArrayActivities([...arrayActivities, ...arrayAct]);\n          setLoading(false);\n          setLoading(true);\n        }, 1000);\n      }\n    }\n\n    if (props.city === \"404\") return;\n\n    const fetchData = async () => {\n      await request(props, offset);\n    };\n\n    fetchData();\n  }, [arrayActivities, props]);\n  useEffect(() => {}, [loading]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"searchAndResult\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"result\",\n      children: props.city ? props.city === \"404\" ? /*#__PURE__*/_jsxDEV(\"h2\", {\n        id: \"error404\",\n        children: \"Sorry we did not find any city with that name \\uD83D\\uDC38\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(CardContainer, {\n          arrayActivities: arrayActivities\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 15\n        }, this)\n      }, void 0, false) : null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Result, \"bIc3QOdwQpmBezi8rvJ+gi1vUek=\");\n\n_c = Result;\nexport default Result;\n\nvar _c;\n\n$RefreshReg$(_c, \"Result\");","map":{"version":3,"sources":["/Users/Samantha/Documents/Education/Wild/Projet2/final/remote-js-202011-froggy-devs/src/components/Result.js"],"names":["React","useState","useEffect","useRef","CardContainer","APIKEY","limit","radius","Result","props","arrayActivities","setArrayActivities","offset","setOffset","loading","setLoading","city","setCity","rain","setRain","inter","clear","window","clearInterval","current","request","arrayAct","coordsCity","fetch","then","res","json","hasOwnProperty","lat","lon","i","setInterval","listActivities","length","activitiesData","xid","kinds","includes","checkedAdult","checkedRelig","checkedRest","checkedSport","checkedShop","push","fetchData"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport CardContainer from \"./CardContainer\";\r\nimport APIKEY from \"./ApiKeyTourism\";\r\n\r\nimport \"./Result.css\";\r\nconst limit = 1;\r\nconst radius = 1000; // in meters\r\n\r\nconst Result = (props) => {\r\n  const [arrayActivities, setArrayActivities] = useState([]);\r\n  const [offset, setOffset] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [city, setCity] = useState(\"\");\r\n  const [rain, setRain] = useState(props.rain);\r\n  const inter = useRef(null);\r\n  const clear = () => {\r\n    window.clearInterval(inter.current);\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function request(props, offset) {\r\n      let arrayAct = [];\r\n      const coordsCity = await fetch(\r\n        `http://api.opentripmap.com/0.1/en/places/geoname?apikey=${APIKEY}&name=${props.city}`,\r\n      ).then((res) => res.json());\r\n      if (coordsCity.hasOwnProperty(\"error\")) arrayAct = \"404\";\r\n      else {\r\n        const { lat, lon } = coordsCity;\r\n        clear();\r\n\r\n        if (city !== props.city || rain !== props.rain) {\r\n          // when the user makes a new research, reset\r\n          setOffset(0);\r\n          setCity(props.city);\r\n          setRain(props.rain);\r\n          setArrayActivities([]);\r\n        }\r\n\r\n        // can't forEach when using async funcions\r\n        let i = 0;\r\n        inter.current = setInterval(async function () {\r\n          const listActivities = await fetch(\r\n            `https://api.opentripmap.com/0.1/en/places/radius?apikey=${APIKEY}&radius=${radius}&limit=${limit}&offset=${offset}&lon=${lon}&lat=${lat}&rate=1&format=json`,\r\n          ).then((res) => res.json());\r\n          if (!listActivities[i] || listActivities.length === 0) {\r\n            clear();\r\n            return;\r\n          }\r\n          const activitiesData = await fetch(\r\n            `https://api.opentripmap.com/0.1/en/places/xid/${listActivities[i].xid}?apikey=${APIKEY}`,\r\n          ).then((res) => res.json());\r\n          if (\r\n            activitiesData.kinds &&\r\n            !(\r\n              activitiesData.kinds.includes(\"accomodation\") ||\r\n              activitiesData.kinds.includes(\"unclassified_objects\") ||\r\n              activitiesData.kinds.includes(\"banks\") ||\r\n              activitiesData.kinds.includes(\"transport\") ||\r\n              activitiesData.kinds.includes(\"industrial\")\r\n            ) &&\r\n            (!props.rain ||\r\n              !(\r\n                activitiesData.kinds.includes(\"natural\") ||\r\n                activitiesData.kinds.includes(\"historic\") ||\r\n                activitiesData.kinds.includes(\"architecture\") ||\r\n                activitiesData.kinds.includes(\"urban_environment\")\r\n              )) &&\r\n            (props.checkedAdult || !activitiesData.kinds.includes(\"adult\")) &&\r\n            (props.checkedRelig ||\r\n              !activitiesData.kinds.includes(\"religion\")) &&\r\n            (props.checkedRest || !activitiesData.kinds.includes(\"foods\")) &&\r\n            (props.checkedSport || !activitiesData.kinds.includes(\"sport\")) &&\r\n            (props.checkedShop || !activitiesData.kinds.includes(\"shops\"))\r\n          ) {\r\n            arrayAct.push(activitiesData);\r\n          }\r\n\r\n          i++;\r\n          setOffset(offset + 1);\r\n          setArrayActivities([...arrayActivities, ...arrayAct]);\r\n          setLoading(false);\r\n          setLoading(true);\r\n        }, 1000);\r\n      }\r\n    }\r\n    if (props.city === \"404\") return;\r\n    const fetchData = async () => {\r\n      await request(props, offset);\r\n    };\r\n    fetchData();\r\n  }, [arrayActivities, props]);\r\n\r\n  useEffect(() => {}, [loading]);\r\n\r\n  return (\r\n    <div className=\"searchAndResult\">\r\n      <div className=\"result\">\r\n        {props.city ? (\r\n          props.city === \"404\" ? (\r\n            <h2 id=\"error404\">\r\n              Sorry we did not find any city with that name 🐸\r\n            </h2>\r\n          ) : (\r\n            <>\r\n              <CardContainer arrayActivities={arrayActivities} />\r\n            </>\r\n          )\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Result;\r\n"]},"metadata":{},"sourceType":"module"}